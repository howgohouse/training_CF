@using CF_ASP_NET.Models;
@{
    ViewBag.Title = "Home Page";
}
@Styles.Render("~/Content/fe-index.css")
@Styles.Render("~/Content/load-fe-control.css")
@Styles.Render("~/Content/main.css")
@Styles.Render("~/Content/main-introduction.css")
@Styles.Render("~/Content/main-investment.css")
@Styles.Render("~/Content/main-news.css")
@Styles.Render("~/Content/main-proposal.css")
@Styles.Render("~/Content/navbar.css")

@Scripts.Render("~/Scripts/scroll-fe-control.js")
@Scripts.Render("~/Scripts/navbar.js")

<div style="display:none">
    <a id="murl" href="~/"></a>
</div>
<div id="load-all" class="load-all">
    <div class="load-main w3-display-container">
        <div class="load8 w3-display-middle">
            <div class="load8-container container1">
                <div class="circle1"></div>
                <div class="circle2"></div>
                <div class="circle3"></div>
                <div class="circle4"></div>
            </div>
            <div class="load8-container container2">
                <div class="circle1"></div>
                <div class="circle2"></div>
                <div class="circle3"></div>
                <div class="circle4"></div>
            </div>
            <div class="load8-container container3">
                <div class="circle1"></div>
                <div class="circle2"></div>
                <div class="circle3"></div>
                <div class="circle4"></div>
            </div>
        </div>
    </div>
</div>
<div id="top-menu" class="top-menu">
    <!-- Image and text -->
    <div class="topnav" id="myTopnav">
        <a onclick="GoPage()" href="#toppage">
            <img src="image/logo.svg" width="36" height="36" class="d-inline-block align-top" alt="">
        </a>
        <a onclick="GoPage()" href="#introduction">本站介紹</a>
        <a onclick="GoPage()" href="#news">消息</a>
        <a onclick="GoPage()" href="#proposal">提案</a>
        <a onclick="GoPage()" href="#investment">探索</a>
        <a href="javascript:void(0);" class="icon" onclick="myFunction()">
            <img src="image/menu.svg" width="36" height="36" class="d-inline-block align-top" alt="">
        </a>
    </div>
    <nav class="navbar navbar-expand-sm navbar-dark" style="display:none;">
        <a class="navbar-brand" onclick="GoPage()" href="#toppage">
            <img src="image/logo.svg" width="36" height="36" class="d-inline-block align-top" alt="">
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
            <img src="image/menu.svg" width="36" height="36" class="d-inline-block align-top" alt="">
        </button>
        <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
            <div class="navbar-nav">
                <a class="nav-item nav-link" onclick="GoPage()" href="#introduction"><font color="white">本站介紹</font></a>
                <a class="nav-item nav-link" onclick="GoPage()" href="#news"><font color="white">消息</font></a>
                <a class="nav-item nav-link" onclick="GoPage()" href="#proposal"><font color="white">提案</font></a>
                <a class="nav-item nav-link" onclick="GoPage()" href="#investment"><font color="white">探索</font></a>
            </div>
        </div>
        <div></div>
    </nav>
</div>
<div class="all">
    <div id="toppage" class="header"></div>
    <div class="main">
        <div class="main-promotional-map">
            <img src="~/image/promotional map.svg" alt="">
        </div>
        <div id="introduction" class="main-interval"></div>
        <div class="main-function-page main-introduction">
            <div class="main-function-page main-introduction-button">
                <div class="main-introduction-button-item">
                    <button onclick="playExplanationDialog(1)" class="w3-button">何謂CF</button>
                </div>
                <div class="main-introduction-button-interval"></div>
                <div class="main-introduction-button-item">
                    <button onclick="playExplanationDialog(2)" class="w3-button">如何募資</button>
                </div>
                <div class="main-introduction-button-interval"></div>
                <div class="main-introduction-button-item">
                    <button onclick="playExplanationDialog(3)" class="w3-button">如何投資</button>
                </div>
            </div>
            <div id="dialog-bg" class="main-introduction-dialog-bg"></div>
            <div id="dialog-explanation-1" class="main-function-page main-introduction-explanation main-introduction-dialog">
                <p class="main-introduction-dialog-header">
                    <img src="image/cancel.svg" width="24" height="24" onclick="displayExplanationDialog(1)" class="d-inline-block align-top" alt="">
                </p>
                <div>
                    <div>
                        <img src="image/crowd-funding.svg" alt="" style="max-width: 360px;max-height: 360px;">
                    </div>
                </div>
                <div class="main-introduction-explanation-padding-top">
                    <p style="font-size: 24px;">
                        CF名稱為Crowd和funding,兩個英文字幕合併成的名稱,本站就如同Crowdfunding的意思,專為您的想法募集您所需要的資金,只要將您的計畫容,於本站提出,就能讓更多的投資者,看見您的計畫
                    </p>
                </div>
            </div>
            <div class="main-function-page main-introduction-explanation">
                <div>
                    <div>
                        <img src="image/crowd-funding.svg" alt="">
                    </div>
                </div>
                <div class="main-introduction-explanation-padding-top">
                    <p>
                        CF名稱為Crowd和funding,兩個英文字幕合併成的名稱,本站就如同Crowdfunding的意思,專為您的想法募集您所需要的資金,只要將您的計畫容,於本站提出,就能讓更多的投資者,看見您的計畫
                    </p>
                </div>
            </div>
            <div id="dialog-explanation-2" class="main-function-page main-introduction-proposal-dialog main-introduction-dialog">
                <p class="main-introduction-dialog-header">
                    <img src="image/cancel.svg" width="24" height="24" onclick="displayExplanationDialog(2)" class="d-inline-block align-top" alt="">
                </p>
                <div>
                    <center>
                        <img class="main-introduction-proposal-dialog-img" width="410" src="image/proposal.png" alt="">
                    </center>
                </div>
            </div>
            <div class="main-function-page main-introduction-proposal">
                <div>
                    <center>
                        <img class="main-introduction-proposal-img align-middle" src="image/proposal.png" alt="">
                    </center>
                </div>
            </div>
            <div id="dialog-explanation-3" class="main-function-page main-introduction-investment-dialog main-introduction-dialog">
                <p class="main-introduction-dialog-header">
                    <img src="image/cancel.svg" width="24" height="24" onclick="displayExplanationDialog(3)" class="d-inline-block align-top" alt="">
                </p>
                <div>
                    <center>
                        <img class="main-introduction-investment-dialog-img" width="758" src="image/investment.png" alt="">
                    </center>
                </div>
            </div>
            <div class="main-function-page main-introduction-investment">
                <div>
                    <center>
                        <img class="main-introduction-investment-img align-middle" src="image/investment.png" alt="">
                    </center>
                </div>
            </div>
        </div>
        <div id="news" class="main-interval"></div>
        <div class="main-function-page-half main-news" style="overflow:hidden;">
            <div>
                @foreach (CfBulletin a in ViewData["DataListNews"] as List<CfBulletin>)
                {
                    <p onclick="playDialog('news',@a.id)">@a.makeTime @a.title</p>
                }
            </div>
        </div>
        <div id="proposal" class="main-interval"></div>
        <div class="main-function-page-half main-proposal">
            <div>
                <p>為您的想法,來此募資</p>
            </div>
            <div class="main-proposal-button">
                <div class="main-proposal-button-item">
                    <center>
                        <button class="w3-button" onclick="playDialog('draft',0)">提案</button>
                    </center>
                </div>
            </div>
        </div>
        <div id="investment" class="main-interval"></div>
        <div id="slide_image_page"></div>
    </div>
    <div id="dialog-cover" class="dialog-cover"></div>
    <div id="dialog" class="dialog">
        <div class="dialog-header">
            <img src="~/image/cancel.svg" width="48" height="48" onclick="displayDialog()" class="d-inline-block align-top" alt="">
        </div>
        <iframe src="" frameborder="0" id="dialog-main" class="dialog-main"></iframe>
    </div>
    <div class="footer">
        CF @("@") copyright
    </div>
</div>
<p id="iswebpshow" style="display:none;">0</p>

<script>
    function WebpIsSupported(callback) {
        // If the browser doesn't has the method createImageBitmap, you can't display webp format
        if (!window.createImageBitmap) {
            callback(false);
            return;
        }

        // Base64 representation of a white point image
        var webpdata = 'data:image/webp;base64,UklGRiQAAABXRUJQVlA4IBgAAAAwAQCdASoCAAEAAQAcJaQAA3AA/v3AgAA=';

        // Retrieve the Image in Blob Format
        fetch(webpdata).then(function (response) {
            return response.blob();
        }).then(function (blob) {
            // If the createImageBitmap method succeeds, return true, otherwise false
            createImageBitmap(blob).then(function () {
                callback(true);
            }, function () {
                callback(false);
            });
        });
    }

    WebpIsSupported(function (isSupported) {
        if (isSupported) {
            $("#iswebpshow").html('1');
        } else {
            //$("#iswebpshow").html('瀏覽器不支援webp');
        }
    });

    function playExplanationDialog(value) {
        var isforwork = true;
        for (var i = 1; (i < 4 & isforwork); i++) {
            if (document.getElementById("dialog-explanation-" + i).style.display == "block") {
                isforwork = false;
                document.getElementById("dialog-bg").classList.remove("main-introduction-dialog-bg-show");
                document.getElementById("dialog-explanation-1").classList.remove('main-introduction-dialog-animation-show');
                document.getElementById("dialog-explanation-1").classList.add('main-introduction-dialog-animation-notshow');
                document.getElementById("dialog-explanation-2").classList.remove('main-introduction-dialog-animation-show');
                document.getElementById("dialog-explanation-2").classList.add('main-introduction-dialog-animation-notshow');
                document.getElementById("dialog-explanation-3").classList.remove('main-introduction-dialog-animation-show');
                document.getElementById("dialog-explanation-3").classList.add('main-introduction-dialog-animation-notshow');
                setTimeout(function () {
                    document.getElementById("dialog-explanation-1").style.display = "none";
                    document.getElementById("dialog-explanation-1").classList.remove('main-introduction-dialog-animation-notshow');
                    document.getElementById("dialog-explanation-2").style.display = "none";
                    document.getElementById("dialog-explanation-2").classList.remove('main-introduction-dialog-animation-notshow');
                    document.getElementById("dialog-explanation-3").style.display = "none";
                    document.getElementById("dialog-explanation-3").classList.remove('main-introduction-dialog-animation-notshow');

                    document.getElementById("dialog-bg").classList.add("main-introduction-dialog-bg-show");
                    document.getElementById("dialog-explanation-" + value).style.display = "block";
                    document.getElementById("dialog-explanation-" + value).classList.add('main-introduction-dialog-animation-show');
                    setTimeout(function () {
                        document.getElementById("top-menu").style.display = "none";
                    }, 500);
                    $('#dialog-main').scrollTop(0);
                }, 500);
            }
        }

        if (isforwork) {
            document.getElementById("dialog-bg").classList.add("main-introduction-dialog-bg-show");
            document.getElementById("dialog-explanation-" + value).style.display = "block";
            document.getElementById("dialog-explanation-" + value).classList.add('main-introduction-dialog-animation-show');
            setTimeout(function () {
                document.getElementById("top-menu").style.display = "none";
            }, 500);
            $('#dialog-main').scrollTop(0);
        }
    }

    function displayExplanationDialog(value) {
        document.getElementById("dialog-bg").classList.remove("main-introduction-dialog-bg-show");
        document.getElementById("dialog-explanation-" + value).classList.remove('main-introduction-dialog-animation-show');
        document.getElementById("dialog-explanation-" + value).classList.add('main-introduction-dialog-animation-notshow');
        document.getElementById("top-menu").style.display = "block";
        setTimeout(function () {
            document.getElementById("dialog-explanation-" + value).style.display = "none";
            document.getElementById("dialog-explanation-" + value).classList.remove('main-introduction-dialog-animation-notshow');
        }, 500);
    }

    function playDialog(function_name, id) {
        playLoad();
        setTimeout(function () {
            switch (function_name) {
                case "draft":
                    function_name = "home/draft";
                    break;
                case "invest":
                    function_name = "home/invest";
                    break;
                case "invest_result":
                    function_name = "home/investresult";
                    break;
                default:
                    function_name = "home/news";
            }
            /*var array =
                { "id": id }
            $.post(document.getElementById("murl").href + "b" + function_name, array,
                function (data) {
                    $("#dialog_main_page").html(data);
                    playDialog();
                }
            );*/
            document.getElementById('dialog-main').src = document.getElementById("murl").href + function_name + "/" + id;
            document.getElementById("dialog").style.display = "block";
            document.getElementById("dialog-cover").style.display = "block";
            document.getElementById("top-menu").style.display = "none";
            $('#dialog-main').scrollTop(0);
        }, 1000);

    }
    function changeDialog(function_name, id) {
        setTimeout(function () {
            switch (function_name) {
                case "draft":
                    function_name = "home/draft";
                    break;
                case "invest":
                    function_name = "home/invest";
                    break;
                case "invest_result":
                    function_name = "home/investresult";
                    break;
                default:
                    function_name = "home/news";
            }
            /*var array =
                { "id": id }
            $.post(document.getElementById("murl").href + "b" + function_name, array,
                function (data) {
                    $("#dialog_main_page").html(data);
                    playDialog();
                }
            );*/
            document.getElementById('dialog-main').src = document.getElementById("murl").href + function_name + "/" + id;
            document.getElementById("dialog").style.display = "block";
            document.getElementById("dialog-cover").style.display = "block";
            document.getElementById("top-menu").style.display = "none";
            $('#dialog-main').scrollTop(0);
        }, 1000);

    }

    function setSlidePage(page) {
        playLoad();
        setTimeout(function () {
            var array =
                { "page": page }
            $.post(document.getElementById("murl").href + 'home/proposallist', array,
                function (data) {
                    $("#slide_image_page").html(data);
                }
            );
        }, 1000);
    }

    function setSlidePageFirst(page) {
        playLoadFirst();
        setTimeout(function () {
            var array =
                { "page": page }
            $.post(document.getElementById("murl").href + 'home/proposallistfirst', array,
                function (data) {
                    $("#slide_image_page").html(data);
                }
            );
        }, 1000);
    }

    function displayDialog() {
        playLoad();
        setTimeout(function () {
            document.getElementById("dialog").style.display = "none";
            document.getElementById("dialog-cover").style.display = "none";
            document.getElementById("top-menu").style.display = "block";
            document.getElementById('dialog-main').src = "";
            setTimeout(function () { displayLoad(); }, 1000);
        }, 1000);
    }

    function displayDialog2() {
        setTimeout(function () {
            document.getElementById("dialog").style.display = "none";
            document.getElementById("dialog-cover").style.display = "none";
            document.getElementById("top-menu").style.display = "block";
            document.getElementById('dialog-main').src = "";
            setTimeout(function () { displayLoad(); }, 1000);
        }, 1000);
    }

    function playLoad() {
        var element = document.getElementById("load-all");
        element.classList.add("load-all-animation-start");
    }
    function displayLoad() {
        var element = document.getElementById("load-all");
        element.classList.remove("load-all-animation-end-first");
        element.classList.remove("load-all-animation-start");
        element.classList.add("load-all-animation-end");
        setTimeout(function () {
            element.classList.remove("load-all-animation-end-first");
            element.classList.remove("load-all-animation-start");
            element.classList.remove("load-all-animation-end");
        }, 1000);
    }
    function playLoadFirst() {
        var element = document.getElementById("load-all");
        element.classList.add("load-all-animation-end-first");
    }

    function GoPage() {
        $("#navbarNavAltMarkup").removeClass('show');
    }

    setSlidePageFirst(0);

    function resetExplanationDialog(y) {
        if (screen.width < 800) {
            if (document.getElementById("dialog-explanation-1").style.display == "block" | document.getElementById("dialog-explanation-2").style.display == "block" | document.getElementById("dialog-explanation-3").style.display == "block") {
                displayExplanationDialog(1);
                displayExplanationDialog(2);
                displayExplanationDialog(3);
            }
        }

        setTimeout(function () {
            resetExplanationDialog();
        }, 500);
    }

    resetExplanationDialog();

    function setMurl() {
        var array =
            { "url": document.getElementById("murl").href }
        $.post(document.getElementById("murl").href + 'bhome/setmurl', array,
            function (data) {
            }
        );
    }

    setMurl();
</script>