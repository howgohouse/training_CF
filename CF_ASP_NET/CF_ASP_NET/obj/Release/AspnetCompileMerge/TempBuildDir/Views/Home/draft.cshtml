@{
    ViewBag.Title = "Home Page";
}
@Styles.Render("~/Content/fe-index.css")
@Styles.Render("~/Content/load-fe-control.css")
@Styles.Render("~/Content/main.css")
@Styles.Render("~/Content/main-introduction.css")
@Styles.Render("~/Content/main-investment.css")
@Styles.Render("~/Content/main-news.css")
@Styles.Render("~/Content/main-proposal.css")

@Scripts.Render("~/Scripts/scroll-fe-control.js")
<a id="murl" href="~/" style="display:none"></a>
<div class="dialog-main-top">
    <p class="col-md-12 dialog-line"></p>
    <p class="col-md-12">
        <label>姓名</label>
        <input id="name" class="w3-input w3-border w3-round-large" onKeyUp="CheckName()" onMouseUp="CheckName()" onChange="CheckName()" type="text">
    <p id="name_check" style="height: 25px;"></p>
    <p id="name_check_value" style="display: none;">0</p>
    </p>
    <p class="col-md-12">
        <label>連絡電話</label>
        <input id="phone" class="w3-input w3-border w3-round-large" onkeyup="CheckPhone()" onmouseup="CheckPhone()" onchange="CheckPhone()" type="text">
    <p id="phone_check" style="height: 25px;"></p>
    <p id="phone_check_value" style="display: none;">0</p>
    </p>
    <p class="col-md-12">
        <label>銀行代碼</label>
        <input id="bank_code" class="w3-input w3-border w3-round-large" onkeyup="CheckBankCode()" onmouseup="CheckBankCode()" onchange="CheckBankCode()" type="text">
    <p id="bank_code_check" style="height: 25px;"></p>
    <p id="bank_code_check_value" style="display: none;">0</p>
    </p>
    <p class="col-md-12">
        <label>銀行名稱</label>
        <input id="bank_name" class="w3-input w3-border w3-round-large" onkeyup="CheckBankName()" onmouseup="CheckBankName()" onchange="CheckBankName()" type="text">
    <p id="bank_name_check" style="height: 25px;"></p>
    <p id="bank_name_check_value" style="display: none;">0</p>
    </p>
    <p class="col-md-12">
        <label>帳戶代碼</label>
        <input id="account_code" class="w3-input w3-border w3-round-large" onkeyup="CheckAccountCode()" onmouseup="CheckAccountCode()" onchange="CheckAccountCode()" type="text">
    <p id="account_code_check" style="height: 25px;"></p>
    <p id="account_code_check_value" style="display: none;">0</p>
    </p>
    <p class="col-md-12">
        <label>帳戶名稱</label>
        <input id="account_name" class="w3-input w3-border w3-round-large" onkeyup="CheckAccountName()" onmouseup="CheckAccountName()" onchange="CheckAccountName()" type="text">
    <p id="account_name_check" style="height: 25px;"></p>
    <p id="account_name_check_value" style="display: none;">0</p>
    </p>
    <p class="col-md-12">
        <label>目標金額</label>
        <input id="target_money" class="w3-input w3-border w3-round-large" onkeyup="CheckTargetMoney()" onmouseup="CheckTargetMoney()" onchange="CheckTargetMoney()" type="number">
    <p id="target_money_check" style="height: 25px;"></p>
    <p id="target_money_check_value" style="display: none;">0</p>
    </p>
    <p class="col-md-12">
        <label>募資結束日期時間</label>
        <input id="end_datetime" class="w3-input w3-border w3-round-large" onkeyup="CheckEndDatetime()" onmouseup="CheckEndDatetime()" onchange="CheckEndDatetime()" type="text">
    <p id="end_datetime_check" style="height: 25px;"></p>
    <p id="end_datetime_check_value" style="display: none;">0</p>
    </p>
    <p class="col-md-12">
        <label>方案的宣傳圖片</label>
        <input id="propaganda_image" class="w3-input w3-border w3-round-large" onchange="CheckPropagandaImage()" type="file">
    <p id="propaganda_image_check" style="height: 25px;"></p>
    <p id="propaganda_image_check_value" style="display: none;">0</p>
    </p>
    <p class="col-md-12">
        <label>方案的標題</label>
        <input id="title" class="w3-input w3-border w3-round-large" onkeyup="CheckTitle()" onmouseup="CheckTitle()" onchange="CheckTitle()" type="text">
    <p id="title_check" style="height: 25px;"></p>
    <p id="title_check_value" style="display: none;">0</p>
    </p>
    <p class="col-md-12">
        <label>方案的簡介</label>
        <textarea name="introduction" id="introduction" class="w3-input w3-border w3-round-large" rows="10" cols="80" onkeyup="CheckIntroduction()" onmouseup="CheckIntroduction()" onchange="CheckIntroduction()"></textarea>
    <p id="introduction_check" style="height: 25px;"></p>
    <p id="introduction_check_value" style="display: none;">1</p>
    </p>
    <p class="col-md-12">
        <label>方案的詳細內容</label>
        <textarea name="content" id="content" class="w3-input w3-border w3-round-large" rows="10" cols="80" onkeyup="CheckContent()" onmouseup="CheckContent()" onchange="CheckContent()"></textarea>
    <p id="content_check" style="height: 25px;"></p>
    <p id="content_check_value" style="display: none;">1</p>
    </p>
    <p class="col-md-12 dialog-line"></p>
</div>
<div class="col-md-12 dialog-main-bottom-button">
    <div class="col-md-4">
        <button id="output" class="w3-button" onclick="post()">確定</button>
    </div>
    <div class="col-md-4">
    </div>
    <div class="col-md-4">
        <button class="w3-button">返回</button>
    </div>
</div>

<script>
    function checkAll() {
        var num = 0;
        num = Number($("#name_check_value").html())
            + Number($("#phone_check_value").html())
            + Number($("#bank_code_check_value").html())
            + Number($("#bank_name_check_value").html())
            + Number($("#account_code_check_value").html())
            + Number($("#account_name_check_value").html())
            + Number($("#target_money_check_value").html())
            + Number($("#end_datetime_check_value").html())
            + Number($("#propaganda_image_check_value").html())
            + Number($("#title_check_value").html())
            + Number($("#introduction_check_value").html())
            + Number($("#content_check_value").html());
        if (num == 12) {
            $("#output").removeClass('w3-disabled');
        } else {
            $("#output").addClass('w3-disabled');
        }
    }

    function CheckName() {
        if ($("#name").val() != '' & $("#name").val().length < 51) {
            $("#name_check").html("");
            $("#name").removeClass('w3-border-red');
            $("#name_check").removeClass('w3-text-red');
            $("#name_check").addClass('w3-text-green');
            $("#name_check_value").html('1');
            checkAll();
        } else if ($("#name").val() != '' & $("#name").val().length > 50) {
            $("#name_check").html("不得超過50個字");
            $("#name").addClass('w3-border-red');
            $("#name_check").removeClass('w3-text-green');
            $("#name_check").addClass('w3-text-red');
            $("#name_check_value").html('0');
            checkAll();
        } else {
            $("#name_check").html("請輸入");
            $("#name").addClass('w3-border-red');
            $("#name_check").removeClass('w3-text-green');
            $("#name_check").addClass('w3-text-red');
            $("#name_check_value").html('0');
            checkAll();
        }
    }

    function CheckPhone() {
        if ($("#phone").val() != '' & $("#phone").val().length < 51) {
            $("#phone_check").html("");
            $("#phone").removeClass('w3-border-red');
            $("#phone_check").removeClass('w3-text-red');
            $("#phone_check").addClass('w3-text-green');
            $("#phone_check_value").html('1');
            checkAll();
        } else if ($("#phone").val() != '' & $("#phone").val().length > 50) {
            $("#phone_check").html("不得超過50個字");
            $("#phone").addClass('w3-border-red');
            $("#phone_check").removeClass('w3-text-green');
            $("#phone_check").addClass('w3-text-red');
            $("#phone_check_value").html('0');
            checkAll();
        } else {
            $("#phone_check").html("請輸入");
            $("#phone").addClass('w3-border-red');
            $("#phone_check").removeClass('w3-text-green');
            $("#phone_check").addClass('w3-text-red');
            $("#phone_check_value").html('0');
            checkAll();
        }
    }

    function CheckBankCode() {
        if ($("#bank_code").val() != '' & $("#bank_code").val().length < 5) {
            $("#bank_code_check").html("");
            $("#bank_code").removeClass('w3-border-red');
            $("#bank_code_check").removeClass('w3-text-red');
            $("#bank_code_check").addClass('w3-text-green');
            $("#bank_code_check_value").html('1');
            checkAll();
        } else if ($("#bank_code").val() != '' & $("#bank_code").val().length > 4) {
            $("#bank_code_check").html("不得超過4個字");
            $("#bank_code").addClass('w3-border-red');
            $("#bank_code_check").removeClass('w3-text-green');
            $("#bank_code_check").addClass('w3-text-red');
            $("#bank_code_check_value").html('0');
            checkAll();
        } else {
            $("#bank_code_check").html("請輸入");
            $("#bank_code").addClass('w3-border-red');
            $("#bank_code_check").removeClass('w3-text-green');
            $("#bank_code_check").addClass('w3-text-red');
            $("#bank_code_check_value").html('0');
            checkAll();
        }
    }

    function CheckBankName() {
        if ($("#bank_name").val() != '' & $("#bank_name").val().length < 51) {
            $("#bank_name_check").html("");
            $("#bank_name").removeClass('w3-border-red');
            $("#bank_name_check").removeClass('w3-text-red');
            $("#bank_name_check").addClass('w3-text-green');
            $("#bank_name_check_value").html('1');
            checkAll();
        } else if ($("#bank_name").val() != '' & $("#bank_name").val().length > 50) {
            $("#bank_name_check").html("不得超過50個字");
            $("#bank_name").addClass('w3-border-red');
            $("#bank_name_check").removeClass('w3-text-green');
            $("#bank_name_check").addClass('w3-text-red');
            $("#bank_name_check_value").html('0');
            checkAll();
        } else {
            $("#bank_name_check").html("請輸入");
            $("#bank_name").addClass('w3-border-red');
            $("#bank_name_check").removeClass('w3-text-green');
            $("#bank_name_check").addClass('w3-text-red');
            $("#bank_name_check_value").html('0');
            checkAll();
        }
    }

    function CheckAccountCode() {
        if ($("#account_code").val() != '' & $("#account_code").val().length < 15) {
            $("#account_code_check").html("");
            $("#account_code").removeClass('w3-border-red');
            $("#account_code_check").removeClass('w3-text-red');
            $("#account_code_check").addClass('w3-text-green');
            $("#account_code_check_value").html('1');
            checkAll();
        } else if ($("#account_code").val() != '' & $("#account_code").val().length > 14) {
            $("#account_code_check").html("不得超過14個字");
            $("#account_code").addClass('w3-border-red');
            $("#account_code_check").removeClass('w3-text-green');
            $("#account_code_check").addClass('w3-text-red');
            $("#account_code_check_value").html('0');
            checkAll();
        } else {
            $("#account_code_check").html("請輸入");
            $("#account_code").addClass('w3-border-red');
            $("#account_code_check").removeClass('w3-text-green');
            $("#account_code_check").addClass('w3-text-red');
            $("#account_code_check_value").html('0');
            checkAll();
        }
    }

    function CheckAccountName() {
        if ($("#account_name").val() != '' & $("#account_name").val().length < 51) {
            $("#account_name_check").html("");
            $("#account_name").removeClass('w3-border-red');
            $("#account_name_check").removeClass('w3-text-red');
            $("#account_name_check").addClass('w3-text-green');
            $("#account_name_check_value").html('1');
            checkAll();
        } else if ($("#account_name").val() != '' & $("#account_name").val().length > 50) {
            $("#account_name_check").html("不得超過50個字");
            $("#account_name").addClass('w3-border-red');
            $("#account_name_check").removeClass('w3-text-green');
            $("#account_name_check").addClass('w3-text-red');
            $("#account_name_check_value").html('0');
            checkAll();
        } else {
            $("#account_name_check").html("請輸入");
            $("#account_name").addClass('w3-border-red');
            $("#account_name_check").removeClass('w3-text-green');
            $("#account_name_check").addClass('w3-text-red');
            $("#account_name_check_value").html('0');
            checkAll();
        }
    }

    function CheckTargetMoney() {
        var max_num = 97199254740991;
        //var min_num = -97199254740991;
        var min_num = 0;

        if ($("#target_money").val() != '' & (!isNaN($("#target_money").val()))) {
            if (Number($("#target_money").val()) <= max_num & Number($("#target_money").val()) > 0) {
                $("#target_money_check").html("");
                $("#target_money").removeClass('w3-border-red');
                $("#target_money_check").removeClass('w3-text-red');
                $("#target_money_check").addClass('w3-text-green');
                $("#target_money_check_value").html('1');
                checkAll();
            } else if ($("#target_money").val() != '' & Number($("#target_money").val()) > max_num) {
                $("#target_money_check").html("不得超過" + max_num);
                $("#target_money").addClass('w3-border-red');
                $("#target_money_check").removeClass('w3-text-green');
                $("#target_money_check").addClass('w3-text-red');
                $("#target_money_check_value").html('0');
                checkAll();
            } else if ($("#target_money").val() != '' & Number($("#target_money").val()) <= 0) {
                $("#target_money_check").html("須超過" + min_num);
                $("#target_money").addClass('w3-border-red');
                $("#target_money_check").removeClass('w3-text-green');
                $("#target_money_check").addClass('w3-text-red');
                $("#target_money_check_value").html('0');
                checkAll();
            }
        } else if ($("#target_money").val() != '' & (isNaN($("#target_money").val()))) {
            $("#target_money_check").html("請輸入數字");
            $("#target_money").addClass('w3-border-red');
            $("#target_money_check").removeClass('w3-text-green');
            $("#target_money_check").addClass('w3-text-red');
            $("#target_money_check_value").html('0');
            checkAll();
        } else {
            $("#target_money_check").html("請輸入數字");
            $("#target_money").addClass('w3-border-red');
            $("#target_money_check").removeClass('w3-text-green');
            $("#target_money_check").addClass('w3-text-red');
            $("#target_money_check_value").html('0');
            checkAll();
        }
    }

    function dateValidationCheck(str) {
        var t = Date.parse(str);
        if (isNaN(t)) {
            return false;
        }
        return true;
    }

    function CheckEndDatetime() {
        if ($("#end_datetime").val() != '' & dateValidationCheck($("#end_datetime").val())) {
            $("#end_datetime_check").html("");
            $("#end_datetime").removeClass('w3-border-red');
            $("#end_datetime_check").removeClass('w3-text-red');
            $("#end_datetime_check").addClass('w3-text-green');
            $("#end_datetime_check_value").html('1');
            checkAll();
        } else if ($("#end_datetime").val() != '' & (!dateValidationCheck($("#end_datetime").val()))) {
            $("#end_datetime_check").html("日期時間格式錯誤");
            $("#end_datetime").addClass('w3-border-red');
            $("#end_datetime_check").removeClass('w3-text-green');
            $("#end_datetime_check").addClass('w3-text-red');
            $("#end_datetime_check_value").html('0');
            checkAll();
        } else {
            $("#end_datetime_check").html("請輸入");
            $("#end_datetime").addClass('w3-border-red');
            $("#end_datetime_check").removeClass('w3-text-green');
            $("#end_datetime_check").addClass('w3-text-red');
            $("#end_datetime_check_value").html('0');
            checkAll();
        }
    }

    function CheckPropagandaImage() {
        var files = null;
        input = document.getElementById('propaganda_image');
        if (!input) {
            $("#propaganda_image_check").html("找不到上傳元件");
            $("#propaganda_image").addClass('w3-border-red');
            $("#propaganda_image_check").removeClass('w3-text-green');
            $("#propaganda_image_check").addClass('w3-text-red');
            $("#propaganda_image_check_value").html('0');
        }
        else if (!input.files) {
            $("#propaganda_image_check").html("瀏覽器不支援檔案的屬性");
            $("#propaganda_image").addClass('w3-border-red');
            $("#propaganda_image_check").removeClass('w3-text-green');
            $("#propaganda_image_check").addClass('w3-text-red');
            $("#propaganda_image_check_value").html('0');
        }
        else if (!input.files[0]) {
            $("#propaganda_image_check").html("請於上傳前,選擇一個檔案");
            $("#propaganda_image").addClass('w3-border-red');
            $("#propaganda_image_check").removeClass('w3-text-green');
            $("#propaganda_image_check").addClass('w3-text-red');
            $("#propaganda_image_check_value").html('0');
        }
        else {
            files = input.files[0];
            var filename = files.name;
            var res = filename.split('.');
            if (files.type == 'image/jpg' | files.type == 'image/jpeg' | files.type == 'image/png' | files.type == 'image/gif' | res[(res.length - 1)] == 'webp') {
                $("#propaganda_image_check").html("");
                $("#propaganda_image").removeClass('w3-border-red');
                $("#propaganda_image_check").removeClass('w3-text-red');
                $("#propaganda_image_check").addClass('w3-text-green');
                $("#propaganda_image_check_value").html('1');
                checkAll();
            } else {
                $("#propaganda_image_check").html("檔案格式不是jpg,png,gif或webp");
                $("#propaganda_image").addClass('w3-border-red');
                $("#propaganda_image_check").removeClass('w3-text-green');
                $("#propaganda_image_check").addClass('w3-text-red');
                $("#propaganda_image_check_value").html('0');
                checkAll();
            }
        }

    }

    function CheckTitle() {
        if ($("#title").val() != '' & $("#title").val().length < 51) {
            $("#title_check").html("");
            $("#title").removeClass('w3-border-red');
            $("#title_check").removeClass('w3-text-red');
            $("#title_check").addClass('w3-text-green');
            $("#title_check_value").html('1');
            checkAll();
        } else if ($("#title").val() != '' & $("#title").val().length > 50) {
            $("#title_check").html("不得超過50個字");
            $("#title").addClass('w3-border-red');
            $("#title_check").removeClass('w3-text-green');
            $("#title_check").addClass('w3-text-red');
            $("#title_check_value").html('0');
            checkAll();
        } else {
            $("#title_check").html("請輸入");
            $("#title").addClass('w3-border-red');
            $("#title_check").removeClass('w3-text-green');
            $("#title_check").addClass('w3-text-red');
            $("#title_check_value").html('0');
            checkAll();
        }
    }

    function CheckIntroduction() {
        if ($("#introduction").html().length < 501) {
            $("#introduction_check").html("");
            $("#introduction").removeClass('w3-border-red');
            $("#introduction_check").removeClass('w3-text-red');
            $("#introduction_check").addClass('w3-text-green');
            $("#introduction_check_value").html('1');
            checkAll();
        } else {
            $("#introduction_check").html("不得超過500個字");
            $("#introduction").addClass('w3-border-red');
            $("#introduction_check").removeClass('w3-text-green');
            $("#introduction_check").addClass('w3-text-red');
            $("#introduction_check_value").html('0');
            checkAll();
        }
    }

    function CheckContent() {
        if ($("#content").html().length < 4001) {
            $("#content_check").html("");
            $("#content").removeClass('w3-border-red');
            $("#content_check").removeClass('w3-text-red');
            $("#content_check").addClass('w3-text-green');
            $("#content_check_value").html('1');
            checkAll();
        } else {
            $("#content_check").html("不得超過4000個字");
            $("#content").addClass('w3-border-red');
            $("#content_check").removeClass('w3-text-green');
            $("#content_check").addClass('w3-text-red');
            $("#content_check_value").html('0');
            checkAll();
        }
    }

    if (screen.width <= 768) {
        try {
            var editor = CKEDITOR.replace('content', {
                extraPlugins: 'uploadimage,image2',//,youtube,html5video,widget,widgetselection,clipboard,lineutils',
                uploadUrl: document.getElementById("murl").href + 'file/uploadckeditor/?',
                filebrowserUploadUrl: document.getElementById("murl").href + 'file/uploadckeditor/?',
                filebrowserImageUploadUrl: document.getElementById("murl").href + 'file/uploadckeditor/?'
            });
            editor.on('change', function (evt) {
                $("#content").html(evt.editor.getData());
            });
        }
        catch (err) {

        }
    } else {
        try {
            var editor = CKEDITOR.replace('content', {
                extraPlugins: 'uploadimage',//,youtube,html5video,widget,widgetselection,clipboard,lineutils',
                uploadUrl: document.getElementById("murl").href + 'file/uploadckeditor/?',
                filebrowserUploadUrl: document.getElementById("murl").href + 'file/uploadckeditor/?',
                filebrowserImageUploadUrl: document.getElementById("murl").href + 'file/uploadckeditor/?'
            });
            editor.on('change', function (evt) {
                $("#content").html(evt.editor.getData());
            });
        }
        catch (err) {

        }
    }

    //輸入欄位設置檢查動作
    setTimeout(function () {
        $("#name").keypress(function (event) {
            return setKeyEnter(event);
        });
        $("#phone").keypress(function (event) {
            return setKeyEnter(event);
        });
        $("#bank_code").keypress(function (event) {
            return setKeyEnter(event);
        });
        $("#bank_name").keypress(function (event) {
            return setKeyEnter(event);
        });
        $("#account_code").keypress(function (event) {
            return setKeyEnter(event);
        });
        $("#account_name").keypress(function (event) {
            return setKeyEnter(event);
        });
        $("#target_money").keypress(function (event) {
            return setKeyEnter(event);
        });
        $("#end_datetime").keypress(function (event) {
            return setKeyEnter(event);
        });
        $("#title").keypress(function (event) {
            return setKeyEnter(event);
        });

        //按鈕狀態重設
        $("#output").addClass('w3-disabled');

        window.parent.displayLoad();
    }, 100);

    //設置Enter Key事件
    function setKeyEnter(event) {
        var keycode = event.keyCode || event.which;
        if (keycode == '13') {
            var num = 0;
            num = Number($("#name_check_value").html())
                + Number($("#phone_check_value").html())
                + Number($("#bank_code_check_value").html())
                + Number($("#bank_name_check_value").html())
                + Number($("#account_code_check_value").html())
                + Number($("#account_name_check_value").html())
                + Number($("#target_money_check_value").html())
                + Number($("#end_datetime_check_value").html())
                + Number($("#propaganda_image_check_value").html())
                + Number($("#title_check_value").html())
                + Number($("#introduction_check_value").html())
                + Number($("#content_check_value").html());
            if (num == 12) {
                post();
            } else {
                CheckName();
                CheckPhone();
                CheckBankCode();
                CheckBankName();
                CheckAccountCode();
                CheckAccountName();
                CheckTargetMoney();
                CheckEndDatetime();
                CheckPropagandaImage();
                CheckTitle();
                CheckIntroduction();
                CheckContent();
            }
            return false;
        }
        return true;
    }

    function openfile(evt) {
        /*var img = evt.target.result;
        var imgx = document.createElement('img');
        imgx.style.margin = "10px";
        imgx.src = img;
        document.getElementById('imgDIV').appendChild(imgx);*/
    }

    function startupload(p_id) {//evt 為 DragEvent 物件
        //$("#startup").prop('disabled', true);
        //$("#uploadinfo").html('正開始上傳');
        var files = null;
        input = document.getElementById('propaganda_image');
        if (!input) {
            alert("找不到上傳元件");
        }
        else if (!input.files) {
            alert("瀏覽器不支援檔案的屬性");
        }
        else if (!input.files[0]) {
            alert("請於上傳前,選擇一個檔案");
        }
        else {
            files = input.files[0];
        }
        var fd = new FormData();
        var xhr = new XMLHttpRequest();
        //var up_progress = document.getElementById('up_progress');
        xhr.open('POST', document.getElementById("murl").href + 'file/upload/?p_id=' + p_id);//上傳到upload.php
        xhr.onload = function () {
            //上傳完成
            //up_progress.innerHTML = '100 %, 上傳完成';
            setTimeout(function () { alert('ok'); }, 100);
        };
        xhr.upload.onprogress = function (evt) {
            //up_progress.innerHTML = '正開始上傳';
            //上傳進度
            if (evt.lengthComputable) {
                var complete = (evt.loaded / evt.total * 100 | 0);
                if (100 == complete) {
                    complete = 99.9;
                }
                //up_progress.innerHTML = complete + ' %';
            }
        }
        files = input.files[0];
        var filename = files.name;
        var res = filename.split('.');
        if (files.type == 'image/jpg' | files.type == 'image/jpeg' | files.type == 'image/png' | files.type == 'image/gif' | res[(res.length - 1)] == 'webp') {
            //將圖片在頁面預覽
            var fr = new FileReader();
            fr.onload = openfile;
            fr.readAsDataURL(files);
            //新增上傳檔案，上傳後名稱為 ff 的陣列
            fd.append('ff[]', files);

            xhr.send(fd);//開始上傳
        } else {
            alert('檔案格式不是jpg,png,gif或webp');
        }

    }

    function post() {
        if (confirm("是否要進行此操作?")) {
            $("#content").html(CKEDITOR.instances['content'].getData());
            var array =
                { "name": $("#name").val(), "phone": $("#phone").val(), "bank_code": $("#bank_code").val(), "bank_name": $("#bank_name").val(), "account_code": $("#account_code").val(), "account_name": $("#account_name").val(), "target_money": $("#target_money").val(), "end_datetime": $("#end_datetime").val(), "title": $("#title").val(), "introduction": $("#introduction").html(), "content": $("#content").html() }
            $.post(document.getElementById("murl").href + 'home/draftrun', array,
                function (data) {
                    var dataStr = JSON.parse(data);
                    startupload(dataStr.p_id);
                }
            );
        }
    }

</script>
